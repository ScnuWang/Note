以太坊和复杂的区块链计划是新的和高度实验性的。因此，随着新bug和安全风险的发现，您应该期待安全形势发生不断变化，并制定新的最佳实践。因此，本文档中的安全措施只是作为智能合同开发人员需要完成的安全工作的开始。

智能合约编程需要与您习惯的不同的工程思维。失败的代价可能很高，并且更改可能很困难，使得它在某些方面更像硬件编程或金融服务编程，而不是Web或移动开发。因此，防御已知的漏洞是不够的。相反，你需要学习一种新的发展理念：



### 准备失败

任何复杂的合同都会有错误。因此，您的代码必须能够优雅地回应错误和漏洞。

- 当逻辑出错时暂停合同（'断路器'）

- 管理风险货币数量（限制利率，最大限度使用）

- 为错误修正和改进提供有效的升级途径

  ​

### 仔细展开

在完整的产品发布前捕获错误总是更好。

- 彻底测试合同，并在发现新的攻击媒介时添加测试。
- 提供从alpha testnet版本开始的bug补丁。
- 分阶段推出，每个阶段的使用和测试都在不断增加。



### 保持合同简单

复杂性增加了出错的可能性。

- 确保合同的逻辑尽量简单。
- 模块化代码以保持合同和功能小。
- 尽可能使用已编写的工具或代码。（例如：不要推出你自己的随机数发生器）
- 只要有可能，请尽量保持清晰。
- 仅对需要分散管理的系统部分使用区块链。



### 保持最新状态

使用下一节中列出的资源跟踪新的安全发展。

- 检查您的合同是否有任何发现的新bug
- 尽快升级到任何工具或库的最新版本
- 采用看起来很有用的新安全技术



### 请注意区块链属性

虽然您的编程经验中的大部分都与以太坊编程有关，但有一些陷阱需要注意。

- 要非常小心外部合同调用，这可能会执行恶意代码并更改控制流。
- 了解你的公共职能是公开的，可能会被恶意地调用。**任何人都可以查看您的私人数据。**
- 记住gas成本和gas的限制。



### 基本权衡：简单性与复杂性案例

在评估智能合约系统的结构和安全性时，需要考虑多个基本权衡。任何智能合约系统的一般建议是为这些基本的权衡找出合适的平衡点。

来自软件工程期望的理想智能合约系统是模块化的，重复使用代码而不是复制代码，并且支持可升级的组件。从安全架构师期望一个理想的智能合约系统能够分享，特别是在更复杂的智能合约系统的情况下。

但是，在安全和软件工程最佳实践可能不一致的情况下，存在重要的例外。在每种情况下，通过确定沿着合同制度维度的最佳性质组合来获得适当的平衡，例如：

- 刚性与可升级性
- 整体与模块化
- 复制与重用



#### 刚性与可升级性

尽管包括这个在内的多种资源强调可展性特性，例如Killable，可升级或可修改模式，但在可塑性和安全性之间存在基本的折衷。

根据定义，可塑性模式增加了复杂性和潜在的攻击表面。在智能合同系统在预定义的有限时间段内执行非常有限的一组功能的情况下，简单性比复杂性特别有效，例如，无管理的有限时间帧令牌销售合同系统。



#### 整体与模块化

一个单一的自包含合同保持所有知识本地可识别和可读。虽然很少有高度重视的智能合约系统作为庞然大物存在，但有一个理由要求数据和流程的极端地点 - 例如，在优化代码审查效率的情况下。

与在此考虑的其他权衡一样，安全最佳实践趋向于简单短期合同中的软件工程最佳实践，以及在更复杂的永久合同系统中趋向软件工程最佳实践的趋势。



#### 复制与重用

从软件工程角度来看，智能合约系统希望在合理的情况下最大限度地提高重用。有很多方法可以重用Solidity中的合同代码。使用您拥有的经过验证的先前部署的合约通常是实现代码重用的最安全方式。

在自有的先前部署的合同不可用的情况下，复制通常是依赖的。诸如Live Libs和Zeppelin Solidity等努力试图提供一些模式，以便可以重复使用安全代码而不会发生重复。任何合同安全分析都必须包括以前没有建立与目标智能合约系统中的风险资金相当的信任等级的任何重复使用的代码。



[本篇原文链接](https://consensys.github.io/smart-contract-best-practices/general_philosophy/)